# üìã –ü–õ–ê–ù –†–ï–ê–õ–ò–ó–ê–¶–ò–ò: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥—Å—á–µ—Ç–∞ —á–∞—à–µ–∫ –∏ –∫–∏–ª–æ–≥—Ä–∞–º–º–æ–≤

**–î–∞—Ç–∞:** 2025-11-08  
**–°—Ç–∞—Ç—É—Å:** üìù –ü–ª–∞–Ω (–≥–æ—Ç–æ–≤ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏)

---

## üéØ –û–ë–©–ê–Ø –ö–û–ù–¶–ï–ü–¶–ò–Ø

**–û—Å–Ω–æ–≤–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ:** –†–∞–∑–¥–µ–ª–∏—Ç—å –æ–¥–∏–Ω –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å –Ω–∞ **—Ç—Ä–∏ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞** –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–æ–¥—Å—á–µ—Ç–∞:
1. **–ß–∞—à–∫–∏** - —Å JOIN –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ —Ç–∏–ø–∞–º
2. **–°—É–º–º—ã** - –ë–ï–ó JOIN (—á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è)
3. **–ö–∏–ª–æ–≥—Ä–∞–º–º—ã** - —Å JOIN –∏ —Ñ–∏–ª—å—Ç—Ä–æ–º –ø–æ ID –≥—Ä—É–ø–ø

---

## üìù –î–ï–¢–ê–õ–¨–ù–´–ô –ü–õ–ê–ù –ò–ó–ú–ï–ù–ï–ù–ò–ô

### 1. **proxy_client.py** - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ SQL –∑–∞–ø—Ä–æ—Å–æ–≤

#### 1.1. –°–æ–∑–¥–∞—Ç—å —Ç—Ä–∏ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞ –≤–º–µ—Å—Ç–æ –¥–≤—É—Ö:

**–¢–µ–∫—É—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
- `SALES_QUERY_TEMPLATE` - –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å (—á–∞—à–∫–∏ + —Å—É–º–º—ã)
- `PACKAGES_QUERY_TEMPLATE` - –∑–∞–ø—Ä–æ—Å –¥–ª—è –∫–∏–ª–æ–≥—Ä–∞–º–º–æ–≤

**–ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
- `CUPS_QUERY_TEMPLATE` - —Ç–æ–ª—å–∫–æ —á–∞—à–∫–∏ (—Å JOIN)
- `SUMS_QUERY_TEMPLATE` - —Ç–æ–ª—å–∫–æ —Å—É–º–º—ã (–ë–ï–ó JOIN)
- `PACKAGES_QUERY_TEMPLATE` - –∫–∏–ª–æ–≥—Ä–∞–º–º—ã (—Å —Ñ–∏–ª—å—Ç—Ä–æ–º –ø–æ ID –≥—Ä—É–ø–ø)

#### 1.2. –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –¥–ª—è ID –≥—Ä—É–ø–ø:

```python
# ID –≥—Ä—É–ø–ø –¥–ª—è —á–∞—à–µ–∫
MONO_CUP_GROUPS = ['24435', '25539', '21671', '25546', '25775', '25777', '25789']
BLEND_CUP_GROUPS = ['23076', '21882', '25767', '248882', '25788']
CAOTINA_CUP_GROUPS = ['24491', '21385']
ALL_CUP_GROUPS = MONO_CUP_GROUPS + BLEND_CUP_GROUPS + CAOTINA_CUP_GROUPS

# ID –≥—Ä—É–ø–ø –¥–ª—è –∫–∏–ª–æ–≥—Ä–∞–º–º–æ–≤ (–ë–ï–ó Caotina!)
PACKAGES_KG_GROUPS = ['11077', '16279', '16276']  # Blend (2) + Mono (1)
```

#### 1.3. –ù–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –¥–ª—è —á–∞—à–µ–∫ (`CUPS_QUERY_TEMPLATE`):

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –ó–∞–º–µ–Ω–∏—Ç—å `COUNT(*)` –Ω–∞ `SUM(GD.Source)`
- ‚úÖ –î–æ–±–∞–≤–∏—Ç—å JOIN —Å `STORZDTGDS` –∏ `GOODS`
- ‚úÖ –î–æ–±–∞–≤–∏—Ç—å —Ä–∞–∑–±–∏–≤–∫—É –ø–æ —Ç–∏–ø–∞–º: `MonoCup`, `BlendCup`, `CaotinaCup`, `AllCup`
- ‚úÖ –î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä –∏—Å–∫–ª—é—á–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –∑–∞–∫–∞–∑–æ–≤
- ‚ùå –£–±—Ä–∞—Ç—å `TOTAL_CASH` –∏–∑ —ç—Ç–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞

#### 1.4. –ù–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –¥–ª—è —Å—É–º–º (`SUMS_QUERY_TEMPLATE`):

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –°–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å —Ç–æ–ª—å–∫–æ –¥–ª—è —Å—É–º–º
- ‚úÖ –ë–ï–ó JOIN —Å —Ç–æ–≤–∞—Ä–∞–º–∏ (—á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è)
- ‚úÖ –î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä –∏—Å–∫–ª—é—á–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –∑–∞–∫–∞–∑–æ–≤
- ‚úÖ –í–µ—Ä–Ω—É—Ç—å —Ç–æ–ª—å–∫–æ `STORE_NAME`, `ORDER_DATE`, `TOTAL_CASH`

#### 1.5. –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å –¥–ª—è –∫–∏–ª–æ–≥—Ä–∞–º–º–æ–≤ (`PACKAGES_QUERY_TEMPLATE`):

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –ó–∞–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—è–º —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ —Ñ–∏–ª—å—Ç—Ä –ø–æ ID –≥—Ä—É–ø–ø
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `G.OWNER IN ('11077', '16279', '16276')`
- ‚úÖ –£–±—Ä–∞—Ç—å Caotina –∏–∑ —Ñ–∏–ª—å—Ç—Ä–∞
- ‚úÖ –£–±—Ä–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä –ø–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º (–∫–∞–∫ –≤ —ç—Ç–∞–ª–æ–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏)
- ‚úÖ –£–±—Ä–∞—Ç—å LEFT JOIN —Å GOODSGROUPS (–Ω–µ –Ω—É–∂–µ–Ω)

#### 1.6. –û–±–Ω–æ–≤–∏—Ç—å –º–µ—Ç–æ–¥ `get_sales()`:

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –í—ã–ø–æ–ª–Ω—è—Ç—å —Ç—Ä–∏ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞
- ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É: `{"cups": [...], "sums": [...], "packages": [...]}`
- ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞

**–ù–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ —á–∞—à–µ–∫:**
```python
params = (
    *MONO_CUP_GROUPS,           # 7 –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è Mono
    *BLEND_CUP_GROUPS,          # 5 –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è Blend
    *CAOTINA_CUP_GROUPS,        # 2 –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –¥–ª—è Caotina
    *ALL_CUP_GROUPS,            # 14 –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è AllCup
    *store_ids,                 # ID –º–∞–≥–∞–∑–∏–Ω–æ–≤
    start_date,                 # –ù–∞—á–∞–ª—å–Ω–∞—è –¥–∞—Ç–∞
    end_date                    # –ö–æ–Ω–µ—á–Ω–∞—è –¥–∞—Ç–∞
)
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ —Å—É–º–º:**
```python
params = [*store_ids, start_date, end_date]
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ –∫–∏–ª–æ–≥—Ä–∞–º–º–æ–≤:**
```python
params = [*store_ids, start_date, end_date, *PACKAGES_KG_GROUPS]
```

---

### 2. **services/analytics.py** - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö

#### 2.1. –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É `SalesRecord`:

```python
@dataclass
class SalesRecord:
    store_name: str
    order_date: date
    cups: int  # –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
    mono_cup: int = 0
    blend_cup: int = 0
    caotina_cup: int = 0
    all_cup: int = 0
    total_cash: Decimal = Decimal("0")
    packages_kg: Decimal = Decimal("0")
```

#### 2.2. –û–±–Ω–æ–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `merge_sales_with_packages()`:

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –≤ `merge_cups_sums_packages()` –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å —Å–∏–≥–Ω–∞—Ç—É—Ä—É
- ‚úÖ –ü—Ä–∏–Ω–∏–º–∞—Ç—å —Ç—Ä–∏ —Å–ø–∏—Å–∫–∞: `cups_rows`, `sums_rows`, `packages_rows`
- ‚úÖ –û–±—ä–µ–¥–∏–Ω—è—Ç—å –ø–æ –∫–ª—é—á—É `(STORE_NAME, ORDER_DATE)`
- ‚úÖ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–æ–≤—ã–µ –ø–æ–ª—è: `MonoCup`, `BlendCup`, `CaotinaCup`, `AllCup`
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å (–µ—Å–ª–∏ –Ω–æ–≤—ã–µ –ø–æ–ª—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç)

**–õ–æ–≥–∏–∫–∞ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è:**
```python
# 1. –û–±—ä–µ–¥–∏–Ω–∏—Ç—å —á–∞—à–∫–∏ –∏ —Å—É–º–º—ã
# 2. –î–æ–±–∞–≤–∏—Ç—å –∫–∏–ª–æ–≥—Ä–∞–º–º—ã
# 3. –°–æ–∑–¥–∞—Ç—å SalesRecord —Å –ø–æ–ª–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
```

#### 2.3. –û–±–Ω–æ–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `summarize_sales()`:

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –∞–≥—Ä–µ–≥–∞—Ü–∏—é –ø–æ —Ç–∏–ø–∞–º —á–∞—à–µ–∫
- ‚úÖ –í–µ—Ä–Ω—É—Ç—å –≤ summary:
  - `total_mono_cup`
  - `total_blend_cup`
  - `total_caotina_cup`
  - `total_all_cup`

---

### 3. **app.py** - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—ã–∑–æ–≤–æ–≤

#### 3.1. –û–±–Ω–æ–≤–∏—Ç—å –≤—ã–∑–æ–≤ `client.get_sales()`:

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –û–∂–∏–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É `{"cups": [...], "sums": [...], "packages": [...]}`
- ‚úÖ –ü–µ—Ä–µ–¥–∞–≤–∞—Ç—å —Ç—Ä–∏ —Å–ø–∏—Å–∫–∞ –≤ `merge_cups_sums_packages()`

**–ü—Ä–∏–º–µ—Ä:**
```python
raw_data = client.get_sales(store_ids, start_date, end_date)
merged = merge_cups_sums_packages(
    raw_data["cups"],
    raw_data["sums"],
    raw_data["packages"]
)
```

---

### 4. **templates/sales_table.html** - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è

#### 4.1. –û–±–Ω–æ–≤–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç —è—á–µ–µ–∫ pivot-—Ç–∞–±–ª–∏—Ü—ã:

**–¢–µ–∫—É—â–∏–π —Ñ–æ—Ä–º–∞—Ç:**
```
–ß–∞—à–∫–∏: 46
–ö–≥: 1.2
‚Çæ: 500
```

**–ù–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç:**
```
CCup: 6
MCup: 10
BCup: 39
üìä: 55
üì¶ 0.25–∫–≥
üí∞ 608.55 –ª–∞—Ä–∏
```

#### 4.2. –£—Å–ª–æ–≤–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ:

- ‚úÖ –ï—Å–ª–∏ –µ—Å—Ç—å –Ω–æ–≤—ã–µ –ø–æ–ª—è (`all_cup > 0` –∏–ª–∏ `mono_cup > 0` –∏ —Ç.–¥.) - –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ
- ‚úÖ –ò–Ω–∞—á–µ - –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç (–¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)

---

### 5. **tests/test_analytics.py** - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤

#### 5.1. –û–±–Ω–æ–≤–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã:

- ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—è –¥–ª—è —Ç–∏–ø–æ–≤ —á–∞—à–µ–∫ –≤ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
- ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å assertions –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π

#### 5.2. –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Ç–µ—Å—Ç—ã:

- ‚úÖ –¢–µ—Å—Ç –Ω–∞ –æ–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å (—Å—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö)
- ‚úÖ –¢–µ—Å—Ç –Ω–∞ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ç—Ä–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –¢–µ—Å—Ç –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –ø–æ–¥—Å—á–µ—Ç–∞ —Ç–∏–ø–æ–≤ —á–∞—à–µ–∫
- ‚úÖ –¢–µ—Å—Ç –Ω–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é —Ç–µ—Å—Ç–æ–≤—ã—Ö –∑–∞–∫–∞–∑–æ–≤

---

## üîë –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–´–ï –ú–û–ú–ï–ù–¢–´

### 1. –†–∞–∑–¥–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- ‚ùå **–ù–ï –æ–±—ä–µ–¥–∏–Ω—è–π—Ç–µ** –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è —á–∞—à–µ–∫ –∏ —Å—É–º–º –≤ –æ–¥–∏–Ω —Å JOIN
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **—Ç—Ä–∏ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞** –∏ –æ–±—ä–µ–¥–∏–Ω—è–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –∫–æ–¥–µ

### 2. COUNT(*) vs SUM(GD.Source)
- ‚ùå `COUNT(*)` - —Å—á–∏—Ç–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ **–∑–∞–∫–∞–∑–æ–≤**
- ‚úÖ `SUM(GD.Source)` - —Å—á–∏—Ç–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ **—Ç–æ–≤–∞—Ä–æ–≤** (—á–∞—à–µ–∫)

**–ü—Ä–∏–º–µ—Ä:**
```
–ó–∞–∫–∞–∑ #123:
  - 2x Espresso (Blend)
  - 1x Cappuccino (Mono)

COUNT(*): 1 ‚ùå (–æ–¥–∏–Ω –∑–∞–∫–∞–∑)
SUM(GD.Source): 3 ‚úÖ (2 + 1 —Ç–æ–≤–∞—Ä–∞)
```

### 3. –°—É–º–º—ã –ë–ï–ó JOIN
- ‚ùå JOIN —Å —Ç–æ–≤–∞—Ä–∞–º–∏ –¥–ª—è —Å—É–º–º - –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—é
- ‚úÖ –°—É–º–º—ã —Å—á–∏—Ç–∞—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ, –ë–ï–ó JOIN —Å —Ç–æ–≤–∞—Ä–∞–º–∏

### 4. –§–∏–ª—å—Ç—Ä –ø–æ ID –≥—Ä—É–ø–ø –¥–ª—è –∫–∏–ª–æ–≥—Ä–∞–º–º–æ–≤
- ‚ùå –§–∏–ª—å—Ç—Ä –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—è–º —Ç–æ–≤–∞—Ä–æ–≤ (`G.NAME LIKE '%250 g%' ...`)
- ‚úÖ –§–∏–ª—å—Ç—Ä –ø–æ ID –≥—Ä—É–ø–ø (`G.OWNER IN ('11077', '16279', '16276')`)

### 5. Caotina –¥–ª—è –∫–∏–ª–æ–≥—Ä–∞–º–º–æ–≤
- ‚ùå **–ù–ï –≤–∫–ª—é—á–∞–π—Ç–µ** Caotina –≤ –∑–∞–ø—Ä–æ—Å –¥–ª—è –∫–∏–ª–æ–≥—Ä–∞–º–º–æ–≤
- ‚úÖ –¢–æ–ª—å–∫–æ 3 –≥—Ä—É–ø–ø—ã: `11077`, `16279`, `16276`

### 6. –§–∏–ª—å—Ç—Ä –ø–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º
- ‚úÖ **–û–±—è–∑–∞—Ç–µ–ª–µ–Ω** –¥–ª—è —á–∞—à–µ–∫ –∏ —Å—É–º–º: `NOT (D.comment LIKE '%–º—ã;%' OR ...)`
- ‚ùå **–ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è** –¥–ª—è –∫–∏–ª–æ–≥—Ä–∞–º–º–æ–≤

---

## üìä ID –ì–†–£–ü–ü –¢–û–í–ê–†–û–í

### –î–ª—è —á–∞—à–µ–∫:

**Mono Cup (Single Origin) - 7 –≥—Ä—É–ø–ø:**
- `24435`, `25539`, `21671`, `25546`, `25775`, `25777`, `25789`

**Blend Cup (–°–º–µ—à–∞–Ω–Ω—ã–µ —Å–æ—Ä—Ç–∞) - 5 –≥—Ä—É–ø–ø:**
- `23076`, `21882`, `25767`, `248882`, `25788`

**Caotina Cup (–®–æ–∫–æ–ª–∞–¥–Ω—ã–µ –Ω–∞–ø–∏—Ç–∫–∏) - 2 –≥—Ä—É–ø–ø—ã:**
- `24491`, `21385`

**–í—Å–µ –≥—Ä—É–ø–ø—ã (–¥–ª—è AllCup) - 14 –≥—Ä—É–ø–ø:**
- –í—Å–µ –≤—ã—à–µ–ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã–µ –≤–º–µ—Å—Ç–µ

### –î–ª—è –∫–∏–ª–æ–≥—Ä–∞–º–º–æ–≤:

**Blend (–ø–∞—á–∫–∏) - 2 –≥—Ä—É–ø–ø—ã:**
- `11077` - Coffee Blasecafe blend (250 g)
- `16279` - Coffee Blasercafe blend (1kg)

**Mono (–ø–∞—á–∫–∏) - 1 –≥—Ä—É–ø–ø–∞:**
- `16276` - Coffee Blasercafe singl origin (250–≥)

**‚ùå Caotina –ù–ï –≤–∫–ª—é—á–∞–µ—Ç—Å—è!** (ID `22939`)

---

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### –û–∂–∏–¥–∞–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (–ø–µ—Ä–∏–æ–¥ 02-03.12.2025):

**–°—É–º–º—ã:**
- BatumiMall: 608.55, 861.95
- CityMall: 698.05, 809.85
- DK Batumi: 342.00, 1014.55
- DK Paliashvili: 2874.00, 640.25
- EastPoint: 452.05, 509.00

**–ö–∏–ª–æ–≥—Ä–∞–º–º—ã:**
- BatumiMall: 0.25, 1.50
- CityMall: 1.00, 1.75
- DK Batumi: 0.75, 4.25
- DK Paliashvili: 3.00, 3.50
- EastPoint: 0.25, 0.50

**–ß–∞—à–∫–∏:** –ü—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –ø–æ —Ç–∏–ø–∞–º (CCup, MCup, BCup, AllCup)

---

## üìã –ß–ï–ö–õ–ò–°–¢ –†–ï–ê–õ–ò–ó–ê–¶–ò–ò

### proxy_client.py
- [ ] –°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –¥–ª—è ID –≥—Ä—É–ø–ø
- [ ] –°–æ–∑–¥–∞—Ç—å `CUPS_QUERY_TEMPLATE` (—Å JOIN, —Ä–∞–∑–±–∏–≤–∫–∞ –ø–æ —Ç–∏–ø–∞–º)
- [ ] –°–æ–∑–¥–∞—Ç—å `SUMS_QUERY_TEMPLATE` (–ë–ï–ó JOIN)
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `PACKAGES_QUERY_TEMPLATE` (—Ñ–∏–ª—å—Ç—Ä –ø–æ ID –≥—Ä—É–ø–ø)
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –º–µ—Ç–æ–¥ `get_sales()` –¥–ª—è —Ç—Ä–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- [ ] –û–±–Ω–æ–≤–∏—Ç—å —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

### services/analytics.py
- [ ] –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É `SalesRecord`
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `merge_sales_with_packages()` ‚Üí `merge_cups_sums_packages()`
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `summarize_sales()` –¥–ª—è –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ —Ç–∏–ø–æ–≤ —á–∞—à–µ–∫

### app.py
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –≤—ã–∑–æ–≤—ã `client.get_sales()`
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –ø–µ—Ä–µ–¥–∞—á—É –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ—É–Ω–∫—Ü–∏—é merge

### templates/sales_table.html
- [ ] –û–±–Ω–æ–≤–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —è—á–µ–µ–∫
- [ ] –î–æ–±–∞–≤–∏—Ç—å —É—Å–ª–æ–≤–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ (–Ω–æ–≤—ã–π/—Å—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç)

### tests/test_analytics.py
- [ ] –û–±–Ω–æ–≤–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –Ω–∞ –æ–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –Ω–∞ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ç—Ä–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

---

## üöÄ –ü–û–†–Ø–î–û–ö –†–ï–ê–õ–ò–ó–ê–¶–ò–ò

1. **–≠—Ç–∞–ø 1:** –û–±–Ω–æ–≤–∏—Ç—å `proxy_client.py` (SQL –∑–∞–ø—Ä–æ—Å—ã –∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã)
2. **–≠—Ç–∞–ø 2:** –û–±–Ω–æ–≤–∏—Ç—å `services/analytics.py` (—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö)
3. **–≠—Ç–∞–ø 3:** –û–±–Ω–æ–≤–∏—Ç—å `app.py` (–≤—ã–∑–æ–≤—ã)
4. **–≠—Ç–∞–ø 4:** –û–±–Ω–æ–≤–∏—Ç—å `templates/sales_table.html` (UI)
5. **–≠—Ç–∞–ø 5:** –û–±–Ω–æ–≤–∏—Ç—å —Ç–µ—Å—Ç—ã
6. **–≠—Ç–∞–ø 6:** –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞

---

## ‚ö†Ô∏è –í–ê–ñ–ù–´–ï –ó–ê–ú–ï–ß–ê–ù–ò–Ø

1. **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** –ö–æ–¥ –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –∏ —Å–æ —Å—Ç–∞—Ä—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º –¥–∞–Ω–Ω—ã—Ö (–±–µ–∑ –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π)
2. **NULL –∑–Ω–∞—á–µ–Ω–∏—è:** –í—Å–µ –Ω–æ–≤—ã–µ –ø–æ–ª—è –º–æ–≥—É—Ç –±—ã—Ç—å NULL - –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∫–∞–∫ 0
3. **–í–∞–ª–∏–¥–∞—Ü–∏—è:** `AllCup` –¥–æ–ª–∂–µ–Ω —Ä–∞–≤–Ω—è—Ç—å—Å—è —Å—É–º–º–µ `MonoCup + BlendCup + CaotinaCup`
4. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –¢—Ä–∏ –∑–∞–ø—Ä–æ—Å–∞ –≤–º–µ—Å—Ç–æ –æ–¥–Ω–æ–≥–æ - –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω–µ–µ, –Ω–æ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏

---

## üìö –°–°–´–õ–ö–ò –ù–ê –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ

- **–≠—Ç–∞–ª–æ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã:** `docs/qwery ubdate/QUERY_REFERENCE.md`
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:** `docs/qwery ubdate/FRONTEND_INTEGRATION_PROMPT.md`
- **–ë—ã—Å—Ç—Ä–∞—è —Å–ø—Ä–∞–≤–∫–∞:** `docs/qwery ubdate/FRONTEND_QUICK_REFERENCE.md`



